--  CREATE USERS TABLE 
SET SERVEROUTPUT ON;
CREATE TABLE Users (
    User_ID NUMBER GENERATED BY DEFAULT AS IDENTITY 
        START WITH 1 
        INCREMENT BY 1 
        PRIMARY KEY,
    Full_Name VARCHAR2(100) NOT NULL,
    Role VARCHAR2(50) NOT NULL,
    Access_Level NUMBER NOT NULL CHECK (Access_Level BETWEEN 1 AND 5),
    Status VARCHAR2(20) DEFAULT 'Active' CHECK (Status IN ('Active', 'Inactive')),
    Created_At TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

COMMIT;
PROMPT "Users table created successfully!";

-- CREATE ZONES TABLE
SET SERVEROUTPUT ON;
CREATE TABLE Zones (
    Zone_ID NUMBER GENERATED BY DEFAULT AS IDENTITY 
        START WITH 1 INCREMENT BY 1 PRIMARY KEY,
    Zone_Name VARCHAR2(100) NOT NULL UNIQUE,
    Required_Access_Level NUMBER NOT NULL CHECK (Required_Access_Level BETWEEN 1 AND 5),
    Created_At TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
COMMIT;
PROMPT "Zones table created successfully!";

-- CREATE ACCESS_LOGS TABLE
SET SERVEROUTPUT ON;
CREATE TABLE Access_Logs (
    Log_ID NUMBER GENERATED BY DEFAULT AS IDENTITY 
        START WITH 1 INCREMENT BY 1 PRIMARY KEY,
    User_ID NUMBER NOT NULL,
    Zone_ID NUMBER NOT NULL,
    Access_Time TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    Status VARCHAR2(10) CHECK (Status IN ('SUCCESS', 'FAILED')),
    CONSTRAINT fk_log_user FOREIGN KEY (User_ID) REFERENCES Users(User_ID) ON DELETE CASCADE,
    CONSTRAINT fk_log_zone FOREIGN KEY (Zone_ID) REFERENCES Zones(Zone_ID) ON DELETE CASCADE
);
COMMIT;
PROMPT "Access_Logs table created successfully!";

-- CREATE ALERTS TABLE
SET SERVEROUTPUT ON;
CREATE TABLE Alerts (
    Alert_ID NUMBER GENERATED BY DEFAULT AS IDENTITY 
        START WITH 1 INCREMENT BY 1 PRIMARY KEY,
    Log_ID NUMBER NOT NULL,
    Alert_Type VARCHAR2(50) NOT NULL,
    Message VARCHAR2(255),
    Created_At TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT fk_alert_log FOREIGN KEY (Log_ID) REFERENCES Access_Logs(Log_ID) ON DELETE CASCADE
);
COMMIT;
PROMPT "Alerts table created successfully!";